rules:
- id: awscdk-sqs-unencryptedqueue
  patterns:
    - pattern: const $X = new sqs.Queue(...)
    - pattern-not: |
        const $X = new sqs.Queue(..., {..., encryption: sqs.QueueEncryption.KMS_MANAGED, ...})
    - pattern-not: |
        const $X = new sqs.Queue(..., {..., encryption: sqs.QueueEncryption.KMS, ...})
  message: |
      Queue $X is missing encryption at rest. Add "encryption: sqs.QueueEncryption.KMS" or "encryption: sqs.QueueEncryption.KMS_MANAGED" to the queue props to enable encryption at rest for the queue.
  languages: [ts]
  severity: WARNING
  metadata: 
      category: security
      references:
        - https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-data-protection.html
      